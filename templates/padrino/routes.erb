# generated by rpcoder

<%= get_application_name %>.controller "api/v<%= get_version %><%= route.to_s %>" do

  <%- funcs.each do |func| -%>
  <%-
    relative_path = func.get_path.sub(route.to_s, "").split(/\/.*?/).last
    validator_params = func.params.map{|i| [i.name.to_s.to_camelcase(false) + ':', ':' + i.to_ruby_type.id2name].join(' ') }.join(', ')
  -%>
  <%= func.get_method.to_s.downcase %> "/<%= relative_path %>", :provides => :json do
    API::<%= func.name.to_camelcase %>Validator.new(<%= validator_params %>).validate(params)
    api = <%= func.name.to_camelcase %>.new(params)
    api.result.response.to_json
  end

  <%- end -%>

end



